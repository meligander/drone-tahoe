{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\melig\\\\OneDrive\\\\Escritorio\\\\prog\\\\Tahoe-drone backend\\\\client\\\\src\\\\components\\\\Schedule\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Moment from 'react-moment';\nimport moment from 'moment';\nimport Calendar from 'react-calendar';\nimport { connect } from 'react-redux';\nimport { checkDayAvailability, checkMonthAvailability } from '../../actions/day';\nimport { updateReservation, registerReservation } from '../../actions/reservation';\nimport Alert from '../Alert';\nimport './Schedule.scss';\n\nconst Schedule = ({\n  job,\n  auth: {\n    loggedUser\n  },\n  reservation: {\n    reservation\n  },\n  day: {\n    availableHours,\n    loadingAvailableHours,\n    disabledDays\n  },\n  checkMonthAvailability,\n  checkDayAvailability,\n\n  /* updateReservation, */\n  registerReservation\n}) => {\n  _s();\n\n  const today = new Date();\n  const type = reservation ? 'update' : 'reserve';\n  const [formData, setFormData] = useState({\n    hourFrom: '',\n    hourTo: '',\n    value: job.price,\n    jobId: job.id,\n    userId: ''\n  });\n  const {\n    hourFrom,\n    hourTo,\n    value\n  } = formData;\n  const [adminValues, setAdminValues] = useState({\n    date: new Date(),\n    tab: 0,\n    toggleModal: false\n  });\n  const {\n    date,\n    tab,\n    toggleModal\n  } = adminValues;\n  useEffect(() => {\n    const today = new Date();\n    checkMonthAvailability(job.id, today.getMonth(), today.getFullYear());\n    if (loggedUser) setFormData(prev => ({ ...prev,\n      userId: loggedUser.id\n    }));\n  }, [checkMonthAvailability, job.id, loggedUser]);\n\n  const onChangeDate = changedDate => {\n    setAdminValues(prev => ({ ...prev,\n      date: changedDate,\n      tab: 1\n    }));\n    checkDayAvailability(moment(changedDate).format('YYYY-MM-DD[T00:00:00Z]'), job.id);\n  };\n\n  const selectHourFrom = time => {\n    const newDate = new Date(date);\n    newDate.setHours(time);\n    let newToDate;\n    newToDate = new Date(newDate);\n    newToDate.setHours(newDate.getHours() + job.time);\n    setFormData(prev => ({ ...prev,\n      hourFrom: newDate,\n      hourTo: newToDate\n    }));\n    setAdminValues(prev => ({ ...prev,\n      tab: 2\n    }));\n  };\n  /* const getToTime = (item) => {\r\n  \tconst time = hourFrom.getHours() + vessel.prices[item].time;\r\n  \tif (time > 24) return time - 24 + ' am';\r\n  \treturn `${time % 12 !== 0 ? time % 12 : 12} ${\r\n  \t\ttime >= 12 && time !== 24 ? 'pm' : 'am'\r\n  \t}`;\r\n  }; */\n\n\n  const tileDisabled = ({\n    date,\n    view\n  }) => {\n    if (view === 'month' && disabledDays.length > 0) {\n      // Check if a date React-Calendar wants to check is on the list of disabled dates\n      return disabledDays.find(dDate => isSameDay(dDate, date));\n    }\n  };\n\n  const isSameDay = (date1, date2) => {\n    if (moment(date1.substring(0, date1.length - 2)).format('MM-DD-YYYY') === moment(date2).format('MM-DD-YYYY')) return true;\n    return false;\n  };\n\n  const createRange = () => {\n    let posibleHours = [];\n\n    for (let x = 0; x < availableHours.length; x++) {\n      let time = availableHours[x][0] === 8 ? 8 : availableHours[x][0] + 1;\n\n      while (availableHours[x][1] - time >= job.time) {\n        posibleHours.push(time);\n        time++;\n      }\n    }\n\n    console.log(posibleHours);\n  };\n\n  const tabOpen = () => {\n    switch (tab) {\n      case 0:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(\"h5\", {\n            className: \"schedule-details-main\",\n            children: \"Pick up a Date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 7\n          }, this)\n        }, void 0, false);\n\n      case 1:\n        return !loadingAvailableHours && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: availableHours.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [createRange(), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"schedule-details-title\",\n              children: \"Time Range:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 10\n            }, this), availableHours.map(timeRange => timeRange.map((hour, i) => {\n              if (timeRange[0] === 8) {}\n\n              /*#__PURE__*/\n              _jsxDEV(\"div\", {\n                className: \"schedule-details-item\",\n                onClick: () => selectHourFrom(hour),\n                children: `${hour % 12 !== 0 ? hour % 12 : 12} ${hour >= 12 ? 'pm' : 'am'}`\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 149,\n                columnNumber: 12\n              }, this);\n            }))]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"schedule-details-main error\",\n            children: \"No availability on this day\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 9\n          }, this)\n        }, void 0, false);\n\n      case 2:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"schedule-details-title\",\n            children: [type === 'update' ? 'New' : 'Reservation', \" Info:\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            className: \"form\",\n            onSubmit: e => {\n              e.preventDefault();\n\n              if (type === 'update') {\n                setAdminValues(prev => ({ ...prev,\n                  toggleModal: !toggleModal\n                }));\n              } else {\n                registerReservation({ ...formData,\n                  hourFrom: moment(hourFrom).format('YYYY-MM-DD[T]HH:mm:SS[Z]'),\n                  hourTo: moment(hourTo).format('YYYY-MM-DD[T]HH:mm:SS[Z]')\n                });\n              }\n            },\n            children: [/*#__PURE__*/_jsxDEV(Alert, {\n              type: \"2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"schedule-details-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"schedule-subtitle\",\n                children: \"Date\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 9\n              }, this), \" \\xA0\", /*#__PURE__*/_jsxDEV(Moment, {\n                date: hourFrom,\n                format: \"MM/DD/YY\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 8\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"schedule-details-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"schedule-subtitle\",\n                children: \"Time:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 9\n              }, this), \" \\xA0\", /*#__PURE__*/_jsxDEV(Moment, {\n                format: \"h a\",\n                date: hourFrom\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 9\n              }, this), \" -\", ' ', /*#__PURE__*/_jsxDEV(Moment, {\n                format: \"h a\",\n                date: hourTo\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 8\n            }, this), type === 'reserve' && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"schedule-details-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-primary\",\n                children: \"Price:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 10\n              }, this), \" $\", value]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 9\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"u-center-text\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"submit\",\n                className: \"btn btn-primary\",\n                children: type === 'update' ? /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"far fa-save\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 215,\n                  columnNumber: 13\n                }, this) + ' Update' : 'Reserve Now!'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 8\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 7\n          }, this)]\n        }, void 0, true);\n\n      default:\n        break;\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"schedule\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"schedule-calendar\",\n      children: /*#__PURE__*/_jsxDEV(Calendar, {\n        value: date,\n        onChange: onChangeDate,\n        minDate: today,\n        maxDate: new Date(today.getFullYear() + 1, today.getMonth(), today.getDate()),\n        onActiveStartDateChange: e => {\n          if (e.view === 'month') {\n            checkMonthAvailability(job.id, e.activeStartDate.getMonth(), e.activeStartDate.getFullYear());\n          }\n        },\n        tileDisabled: tileDisabled\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"schedule-details\",\n      children: tabOpen()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Schedule, \"ALM6RyC4dEHcybE3cYf4KCGrO1A=\");\n\n_c = Schedule;\n\nconst mapStateToProps = state => ({\n  auth: state.auth,\n  day: state.day,\n  reservation: state.reservation\n});\n\nexport default connect(mapStateToProps, {\n  checkDayAvailability,\n  checkMonthAvailability,\n  updateReservation,\n  registerReservation\n})(Schedule);\n\nvar _c;\n\n$RefreshReg$(_c, \"Schedule\");","map":{"version":3,"sources":["C:/Users/melig/OneDrive/Escritorio/prog/Tahoe-drone backend/client/src/components/Schedule/index.js"],"names":["React","useState","useEffect","Moment","moment","Calendar","connect","checkDayAvailability","checkMonthAvailability","updateReservation","registerReservation","Alert","Schedule","job","auth","loggedUser","reservation","day","availableHours","loadingAvailableHours","disabledDays","today","Date","type","formData","setFormData","hourFrom","hourTo","value","price","jobId","id","userId","adminValues","setAdminValues","date","tab","toggleModal","getMonth","getFullYear","prev","onChangeDate","changedDate","format","selectHourFrom","time","newDate","setHours","newToDate","getHours","tileDisabled","view","length","find","dDate","isSameDay","date1","date2","substring","createRange","posibleHours","x","push","console","log","tabOpen","map","timeRange","hour","i","e","preventDefault","getDate","activeStartDate","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Moment from 'react-moment';\r\nimport moment from 'moment';\r\nimport Calendar from 'react-calendar';\r\nimport { connect } from 'react-redux';\r\n\r\nimport {\r\n\tcheckDayAvailability,\r\n\tcheckMonthAvailability,\r\n} from '../../actions/day';\r\nimport {\r\n\tupdateReservation,\r\n\tregisterReservation,\r\n} from '../../actions/reservation';\r\n\r\nimport Alert from '../Alert';\r\nimport './Schedule.scss';\r\n\r\nconst Schedule = ({\r\n\tjob,\r\n\tauth: { loggedUser },\r\n\treservation: { reservation },\r\n\tday: { availableHours, loadingAvailableHours, disabledDays },\r\n\tcheckMonthAvailability,\r\n\tcheckDayAvailability,\r\n\t/* updateReservation, */\r\n\tregisterReservation,\r\n}) => {\r\n\tconst today = new Date();\r\n\tconst type = reservation ? 'update' : 'reserve';\r\n\r\n\tconst [formData, setFormData] = useState({\r\n\t\thourFrom: '',\r\n\t\thourTo: '',\r\n\t\tvalue: job.price,\r\n\t\tjobId: job.id,\r\n\t\tuserId: '',\r\n\t});\r\n\r\n\tconst { hourFrom, hourTo, value } = formData;\r\n\r\n\tconst [adminValues, setAdminValues] = useState({\r\n\t\tdate: new Date(),\r\n\t\ttab: 0,\r\n\t\ttoggleModal: false,\r\n\t});\r\n\r\n\tconst { date, tab, toggleModal } = adminValues;\r\n\r\n\tuseEffect(() => {\r\n\t\tconst today = new Date();\r\n\r\n\t\tcheckMonthAvailability(job.id, today.getMonth(), today.getFullYear());\r\n\r\n\t\tif (loggedUser) setFormData((prev) => ({ ...prev, userId: loggedUser.id }));\r\n\t}, [checkMonthAvailability, job.id, loggedUser]);\r\n\r\n\tconst onChangeDate = (changedDate) => {\r\n\t\tsetAdminValues((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\tdate: changedDate,\r\n\t\t\ttab: 1,\r\n\t\t}));\r\n\t\tcheckDayAvailability(\r\n\t\t\tmoment(changedDate).format('YYYY-MM-DD[T00:00:00Z]'),\r\n\t\t\tjob.id\r\n\t\t);\r\n\t};\r\n\r\n\tconst selectHourFrom = (time) => {\r\n\t\tconst newDate = new Date(date);\r\n\t\tnewDate.setHours(time);\r\n\r\n\t\tlet newToDate;\r\n\r\n\t\tnewToDate = new Date(newDate);\r\n\t\tnewToDate.setHours(newDate.getHours() + job.time);\r\n\r\n\t\tsetFormData((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\thourFrom: newDate,\r\n\t\t\thourTo: newToDate,\r\n\t\t}));\r\n\r\n\t\tsetAdminValues((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\ttab: 2,\r\n\t\t}));\r\n\t};\r\n\r\n\t/* const getToTime = (item) => {\r\n\t\tconst time = hourFrom.getHours() + vessel.prices[item].time;\r\n\t\tif (time > 24) return time - 24 + ' am';\r\n\t\treturn `${time % 12 !== 0 ? time % 12 : 12} ${\r\n\t\t\ttime >= 12 && time !== 24 ? 'pm' : 'am'\r\n\t\t}`;\r\n\t}; */\r\n\r\n\tconst tileDisabled = ({ date, view }) => {\r\n\t\tif (view === 'month' && disabledDays.length > 0) {\r\n\t\t\t// Check if a date React-Calendar wants to check is on the list of disabled dates\r\n\t\t\treturn disabledDays.find((dDate) => isSameDay(dDate, date));\r\n\t\t}\r\n\t};\r\n\r\n\tconst isSameDay = (date1, date2) => {\r\n\t\tif (\r\n\t\t\tmoment(date1.substring(0, date1.length - 2)).format('MM-DD-YYYY') ===\r\n\t\t\tmoment(date2).format('MM-DD-YYYY')\r\n\t\t)\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t};\r\n\r\n\tconst createRange = () => {\r\n\t\tlet posibleHours = [];\r\n\r\n\t\tfor (let x = 0; x < availableHours.length; x++) {\r\n\t\t\tlet time = availableHours[x][0] === 8 ? 8 : availableHours[x][0] + 1;\r\n\t\t\twhile (availableHours[x][1] - time >= job.time) {\r\n\t\t\t\tposibleHours.push(time);\r\n\t\t\t\ttime++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log(posibleHours);\r\n\t};\r\n\r\n\tconst tabOpen = () => {\r\n\t\tswitch (tab) {\r\n\t\t\tcase 0:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<h5 className='schedule-details-main'>Pick up a Date</h5>\r\n\t\t\t\t\t</>\r\n\t\t\t\t);\r\n\t\t\tcase 1:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t!loadingAvailableHours && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{availableHours.length > 0 ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{createRange()}\r\n\t\t\t\t\t\t\t\t\t<p className='schedule-details-title'>Time Range:</p>\r\n\t\t\t\t\t\t\t\t\t{availableHours.map((timeRange) =>\r\n\t\t\t\t\t\t\t\t\t\ttimeRange.map((hour, i) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (timeRange[0] === 8) {\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName='schedule-details-item'\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={i}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => selectHourFrom(hour)}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{`${hour % 12 !== 0 ? hour % 12 : 12} ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\thour >= 12 ? 'pm' : 'am'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>;\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<h2 className='schedule-details-main error'>\r\n\t\t\t\t\t\t\t\t\tNo availability on this day\r\n\t\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\tcase 2:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<p className='schedule-details-title'>\r\n\t\t\t\t\t\t\t{type === 'update' ? 'New' : 'Reservation'} Info:\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<form\r\n\t\t\t\t\t\t\tclassName='form'\r\n\t\t\t\t\t\t\tonSubmit={(e) => {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t\t\tif (type === 'update') {\r\n\t\t\t\t\t\t\t\t\tsetAdminValues((prev) => ({\r\n\t\t\t\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\t\t\t\ttoggleModal: !toggleModal,\r\n\t\t\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tregisterReservation({\r\n\t\t\t\t\t\t\t\t\t\t...formData,\r\n\t\t\t\t\t\t\t\t\t\thourFrom: moment(hourFrom).format(\r\n\t\t\t\t\t\t\t\t\t\t\t'YYYY-MM-DD[T]HH:mm:SS[Z]'\r\n\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\thourTo: moment(hourTo).format('YYYY-MM-DD[T]HH:mm:SS[Z]'),\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Alert type='2' />\r\n\t\t\t\t\t\t\t<p className='schedule-details-info'>\r\n\t\t\t\t\t\t\t\t<span className='schedule-subtitle'>Date</span> &nbsp;\r\n\t\t\t\t\t\t\t\t<Moment date={hourFrom} format='MM/DD/YY' />\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<p className='schedule-details-info'>\r\n\t\t\t\t\t\t\t\t<span className='schedule-subtitle'>Time:</span> &nbsp;\r\n\t\t\t\t\t\t\t\t<Moment format='h a' date={hourFrom} /> -{' '}\r\n\t\t\t\t\t\t\t\t<Moment format='h a' date={hourTo} />\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t{type === 'reserve' && (\r\n\t\t\t\t\t\t\t\t<p className='schedule-details-info'>\r\n\t\t\t\t\t\t\t\t\t<span className='text-primary'>Price:</span> ${value}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t<div className='u-center-text'>\r\n\t\t\t\t\t\t\t\t<button type='submit' className='btn btn-primary'>\r\n\t\t\t\t\t\t\t\t\t{type === 'update'\r\n\t\t\t\t\t\t\t\t\t\t? <i className='far fa-save'></i> + ' Update'\r\n\t\t\t\t\t\t\t\t\t\t: 'Reserve Now!'}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</>\r\n\t\t\t\t);\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className='schedule'>\r\n\t\t\t{/* {type === 'update' && (\r\n\t\t\t\t<PopUp\r\n\t\t\t\t\ttoggleModal={toggleModal}\r\n\t\t\t\t\tsetToggleModal={() =>\r\n\t\t\t\t\t\tsetAdminValues((prev) => ({\r\n\t\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\t\ttoggleModal: !toggleModal,\r\n\t\t\t\t\t\t}))\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconfirm={() =>\r\n\t\t\t\t\t\tupdateReservation(\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\thourFrom: moment(hourFrom).format('YYYY-MM-DD[T]HH:mm:SS[Z]'),\r\n\t\t\t\t\t\t\t\thourTo: moment(hourTo).format('YYYY-MM-DD[T]HH:mm:SS[Z]'),\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\treservation.id,\r\n\t\t\t\t\t\t\tloggedUser.type\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttext='Are you sure you want to modify the reservation?'\r\n\t\t\t\t\ttype='confirmation'\r\n\t\t\t\t/>\r\n\t\t\t)} */}\r\n\r\n\t\t\t<div className='schedule-calendar'>\r\n\t\t\t\t<Calendar\r\n\t\t\t\t\tvalue={date}\r\n\t\t\t\t\tonChange={onChangeDate}\r\n\t\t\t\t\tminDate={today}\r\n\t\t\t\t\tmaxDate={\r\n\t\t\t\t\t\tnew Date(today.getFullYear() + 1, today.getMonth(), today.getDate())\r\n\t\t\t\t\t}\r\n\t\t\t\t\tonActiveStartDateChange={(e) => {\r\n\t\t\t\t\t\tif (e.view === 'month') {\r\n\t\t\t\t\t\t\tcheckMonthAvailability(\r\n\t\t\t\t\t\t\t\tjob.id,\r\n\t\t\t\t\t\t\t\te.activeStartDate.getMonth(),\r\n\t\t\t\t\t\t\t\te.activeStartDate.getFullYear()\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ttileDisabled={tileDisabled}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<div className='schedule-details'>{tabOpen()}</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst mapStateToProps = (state) => ({\r\n\tauth: state.auth,\r\n\tday: state.day,\r\n\treservation: state.reservation,\r\n});\r\n\r\nexport default connect(mapStateToProps, {\r\n\tcheckDayAvailability,\r\n\tcheckMonthAvailability,\r\n\tupdateReservation,\r\n\tregisterReservation,\r\n})(Schedule);\r\n"]},"metadata":{},"sourceType":"module"}